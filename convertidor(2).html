<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href="<%= BASE_URL %>favicon.ico">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <title>Convertidor</title>

    <script>

function addData(){
    //obtenemos el valor del input
    var inputValue = document.getElementById("numero").value;

    var datosNuevos = localStorage.getItem('datos');
    datosNuevos = datosNuevos === null ? [] : JSON.parse(datosNuevos);

    datosNuevos.push(inputValue);
    
    localStorage.setItem('datos', JSON.stringify(datosNuevos));

    const datos = JSON.parse(localStorage.getItem('datos'));
    const datosSelect = document.getElementById('datos').options.length;
    console.log(datos);

    //actualizaSelect();
    //if(datos.length == datosSelect){} 
        let  html  = '';

        for(let i=0; i<localStorage.length; i++) {
            datos.forEach(function(datos) {
            //debugger;
            html += `
            <option value = "${datos}">${datos}</option>
            
            `;
        });

            const select = document.querySelector('#datos');
            select.innerHTML = html;
}
}


function addOptions(){

const datos = JSON.parse(localStorage.getItem('datos'));
const datosSelect = document.getElementById('datos').options.length;

console.log(datosSelect)
if(datos.length == datosSelect){} 

let  html  = '';

for(let i=0; i<localStorage.length; i++) {
    datos.forEach(function(datos) {
    //debugger;
    html += `
    <option value = "${datos}">${datos}</option>
    `;
});

    const select = document.querySelector('#datos');
    select.innerHTML = html;
}
}

function actualizaSelect (){
    const datos = JSON.parse(localStorage.getItem('datos'));

    const datosSelect = document.getElementById("datos").value.length;
    
    let contar = datos.length;
    debugger
    if(contar == datosSelect){ console.log( "paso") }
    else{addOptions()}

}


</script>
  </head>
  <body>
      <div class="text-center">
        <h1>Convertidor</h1>
      </div>
   <div class="row">
       <div class="col-6">
           <div class="container">
            <div class="mb-3">
               <label for="numero" class="form-label">Ingresar un numero</label>
               <input type="number" class="form-control" id="numero" name="numero" pattern="[0-9]+" >
            </div>
            <div>
               <input type="submit" class="btn btn-primary" value="Agregar" onclick="addData()">
            </div>
        </div>

       </div>

       <div class="col-6">
        <div class="container">
            <div class="mb-3">
                <label for="numero" class="form-label">Seleccionar un numero</label>
                <select class="form-select numero2" id="datos" name="datos" placeholder="Seleccione un número">
                </select>
                
            </div>

            <div class="mb-3">
                <label for="numero" class="form-label">Ingresar un numero</label>
                <input type="number" class="form-control" name="numero2" id="numero2" pattern="[0-9]+">
            </div>

            <div class="text-center">
                <input type="button" class="bt btn-primary" value="Calcular" onclick="principal()">
            </div>

            <label id="respuesta">Repuesta:</label>
        </div>
           
        </div>

   </div>


    <script>
        /*onclick="mutiplicador()"*/
        function obtenerValor(valor){

            var opciones = [];

            document.getElementById("add").onclick = function () {

                for(var i = 1; i < datos.length; i++){
                  
                  if(datos[i][2] == ""){} else{ var o = document.createElement("option"); o.text = datos[i][2]; document.getElementById("departamentoevento").appendChild(o); }
                  
                }
        }
    }


        function mutiplicador(){
            var numero1 = document.getElementById("datos").value;
            var numero2 = document.getElementById("numero2").value;

               console.log(decimalABinario(numero1))
               console.log(decimalABinario(numero2)) 

        }

        
        function principal(){
  var opcion = "multiplicacion";
  var numero1 = document.getElementById("datos").value;
  var numero2 = document.getElementById("numero2").value;

  if(comprobarNumeroBinario(numero1+"") != true && comprobarNumeroBinario(numero2+"") != true){
     numero1 = parseInt(document.getElementById("datos").value);
     numero2 = parseInt(document.getElementById("numero2").value);

    if(opcion == "multiplicacion"){
      numero_1 = bin_decimal(numero1+"");
      numero_2 = bin_decimal(numero2+"");
      
      var resultado= parseInt(multiplicacion(numero_1, numero_2));
      var binario = resultado.toString(2);
      document.getElementById("respuesta").innerHTML = "RESULTADO EN BINARIO: "+binario+" RESULTADO EN DECIMAL: "+ numero_1+"*"+numero_2+" = "+resultado;
    }
}else{
    alert("Debe ser números binarios");
    document.getElementById("numero1").value ="";
    document.getElementById("numero2").value ="";
  }




function multiplicacion(numero_1, numero_2){
  return numero_1*numero_2;
}

//Comprueba si el numero es binario
function comprobarNumeroBinario(numero_binario){
  var comprobacion = false;
  for (var i = 0; i < numero_binario.length; i++) {
    if(numero_binario[i] != "1" && numero_binario[i]!= "0"){
      comprobacion = true;
    }
  }
  return comprobacion;
}

//Pasa de decimal a entero
function bin_decimal(numero_binario){
  var exponente = 0;
  var numero_decimal = 0;
  //El metodo recorre el numero desde el ultimo hasta el primero 1110 = 0111
  for (var i = numero_binario.length-1; i>= 0; i--) {
    if (numero_binario[i]== 1) {
      numero_decimal = numero_decimal + Math.pow(2,exponente);
    }
       exponente++;
  }
       return numero_decimal;
}
}


function decimalABinario(numero){
        // take input
        const number = parseInt(numero);

        // convert to binary
        const result = number.toString(2);

        return result
        }

    </script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  </body>
</html>